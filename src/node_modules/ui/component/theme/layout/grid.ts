import  BaseLayout from "ui/component/layout";
import * as $ from "jquery/dist/jquery.min.js";

export default class Grid extends BaseLayout
{
    public initScope(data: object = null) {
        super.initScope(data);
        this.scope.collapse = function(e) {
            e.preventDefault();
            e.stopPropagation();
            const a = $(e.target).closest("a");
            if (a.find("i").hasClass("fa-angle-down")) {
                a.find("i").removeClass("fa-angle-down").addClass("fa-angle-up");
            } else {
                a.find("i").addClass("fa-angle-down").removeClass("fa-angle-up");
            }
            a.parent().next().toggleClass("d-none");
        }
    }

    public static template() {
        return `
            <div class="row gy-0 {{class}}">
                {{#each components}}
                <div data-index="{{@index}}" class="mm-drop-zone {{echo this.option.class this.option.class}}">
                    {{#if this.option.label}}
                    <label class="form-label">
                        {{#if this.option.collapsible}}
                        <a href="" mm-click="this.collapse(event)"><i class="fa fa-angle-down"></i></a>
                        {{/if}}
                        {{{this.option.label}}}
                    </label>
                    {{/if}}
                    <mm-component name="{{this.comp.name}}" type="{{this.comp.type}}" class="{{echo this.option.collapsible 'd-none'}}"></mm-component>
                </div>
                {{/each}}
            </div>
        `;
    }

    public static properties() {
        let props = super.properties();

        props["dropable"]["default"] = true;
        props["dropZone"]["default"] = ".mm-drop-zone";

        return props;
    }
}